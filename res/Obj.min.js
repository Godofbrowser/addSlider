function generateGUID(){do var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,s="x"==e?t:3&t|8;return s.toString(16)});while(GUIDList.indexOf(e)>-1);return e}function Obj(){this._parent=null,this._handlers=[],this._onceHandlers=[],this._elements=$(),this.guid=generateGUID(),this.on=function(e,t){"function"==typeof e&&void 0===t&&(t=e,e="all"),e=e.toLowerCase().split(" ");for(var s=0;s<e.length;s++)this._handlers.push({event:e[s],handler:t});return this},this.once=function(e,t){"function"==typeof e&&void 0===t&&(t=e,e="all"),e=e.toLowerCase().split(" ");for(var s=0;s<e.length;s++)this._onceHandlers.push({event:e[s],handler:t});return this},this.off=function(e,t){if(void 0===t&&"function"==typeof e)for(var t=e,s=0;s<this._handlers.length;s++)this._handlers[s].handler==t&&this._handlers.splice(s--,1);else if(void 0===t&&"string"==typeof e){e=e.toLowerCase().split(" ");for(var s=0;s<this._handlers.length;s++)e.indexOf(this._handlers[s].event)>-1&&this._handlers.splice(s--,1)}else{e=e.toLowerCase().split(" ");for(var s=0;s<this._handlers.length;s++)e.indexOf(this._handlers[s].event)>-1&&this._handlers[s].handler==t&&this._handlers.splice(s--,1)}return this},this.offOnce=function(e,t){if(void 0===t&&"function"==typeof e)for(var t=e,s=0;s<this._onceHandlers.length;s++)this._onceHandlers[s].handler==t&&this._onceHandlers.splice(s--,1);else if(void 0===t&&"string"==typeof e){e=e.toLowerCase().split(" ");for(var s=0;s<this._onceHandlers.length;s++)e.indexOf(this._onceHandlers[s].event)>-1&&this._onceHandlers.splice(s--,1)}else{e=e.toLowerCase().split(" ");for(var s=0;s<this._onceHandlers.length;s++)e.indexOf(this._onceHandlers[s].event)>-1&&this._onceHandlers[s].handler==t&&this._onceHandlers.splice(s--,1)}return this},this.trigger=function(e,t){e=e.toLowerCase().split(" ");for(var s=0;s<this._handlers.length;s++)(e.indexOf(this._handlers[s].event)>-1||"all"==this._handlers[s].event)&&this._handlers[s].handler.call(this,this._handlers[s].event,t);for(var s=0;s<this._onceHandlers.length;s++)(e.indexOf(this._onceHandlers[s].event)>-1||"all"==this._handlers[s].event)&&(this._onceHandlers[s].handler.call(this,this._onceHandlers[s].event,t),this._onceHandlers.splice(s--,1));return this},this.subscribe=function(e){return void 0!=e.listener&&"function"==typeof e.listener&&this.on("all",e.listener),this},this.ubsubscribe=function(e){return void 0!=e.listener&&"function"==typeof e.listener&&this.off("all",e.listener),this},this.publish=function(e,t){return this.trigger(e,t)},this.renderer=function(){return $("<div class='Obj'></div>")},this.refresher=function(e){return this.renderer.apply(this)},this.destroyer=function(e){},this.render=function(e,t){var s=this;if(void 0===e)var e="body";if(void 0===t)var t="replace";else t=t.toLowerCase();var n=[].slice.call(arguments,2),i=this;return $(e).each(function(e,r){r=$(r);var h=$(s.renderer.apply(s,n));h.attr("guid",s.guid),s._elements=s._elements.add(h),"append"==t?r.append(h):"prepend"==t?r.prepend(h):"after"==t?r.after(h):"before"==t?r.before(h):"return"==t?i=h:"none"==t||(r.after(h),r.remove())}),this.trigger("render"),i},this.refresh=function(){for(var e=$(),t=0;t<this._elements.length;t++){var s=this._elements.eq(t),n=this.refresher.call(this,s);n?(s.after(n),s.remove(),e=e.add(n)):e=e.add(s)}return this._elements=e,this},this.destroy=function(){var e=this;return this._elements.each(function(t,s){var n=$(s);e.destroyer.call(e,n)}),this._elements.remove(),this._elements=$(),delete Objs[this.guid],this},Objs[this.guid]=this}var GUIDList=[],Objs={};